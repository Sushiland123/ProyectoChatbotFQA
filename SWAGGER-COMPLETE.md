# 📚 Documentación Swagger - Sistema Completo\n\n## 🌐 **URLs de Documentación**\n\n### 📖 **Swagger UI por Microservicio:**\n\n| Microservicio | Puerto | Swagger URL | Descripción |\n|---------------|--------|-------------|-------------|\n| **🌐 API Gateway** | 3000 | http://localhost:3000/api/docs | **Punto de entrada principal** |\n| **🔐 Auth Service** | 3001 | http://localhost:3001/api/docs | Autenticación y usuarios |\n| **❓ FAQ Service** | 3002 | http://localhost:3002/api/docs | Gestión de preguntas frecuentes |\n| **🤖 Chatbot Service** | 3003 | http://localhost:3003/api/docs | Motor de conversación |\n\n## 🚀 **Instalación de Swagger en todos los servicios**\n\n### **Opción 1: Instalar todo de una vez**\n```bash\nnpm run install:swagger\n```\n\n### **Opción 2: Instalar por servicio**\n```bash\n# API Gateway\nnpm run install:swagger:gateway\n\n# Auth Service  \nnpm run install:swagger:auth\n\n# FAQ Service\nnpm run install:swagger:faq\n\n# Chatbot Service (ya instalado)\nnpm run install:swagger:chatbot\n```\n\n### **Opción 3: Manual (si hay problemas)**\n```bash\n# En cada directorio de servicio:\ncd api-gateway\nnpm install @nestjs/swagger@7.4.2 swagger-ui-express@5.0.0 class-validator@0.14.1 class-transformer@0.5.1 --force\n\ncd ../auth-service\nnpm install @nestjs/swagger@7.4.2 swagger-ui-express@5.0.0 class-validator@0.14.1 class-transformer@0.5.1 --force\n\n# etc...\n```\n\n## 🔧 **Configuración por Servicio**\n\n### 🌐 **API Gateway (Puerto 3000)**\n- **Color:** Verde 🟢\n- **Función:** Punto de entrada y proxy\n- **Autenticación:** JWT Bearer Token\n- **Rutas:** `/auth/*`, `/chat/*`, `/faq/*`\n\n### 🔐 **Auth Service (Puerto 3001)**  \n- **Color:** Azul 🔵\n- **Función:** Gestión de usuarios y JWT\n- **Endpoints:** Login, Register, Profile\n- **Sin autenticación:** Para login/register\n\n### ❓ **FAQ Service (Puerto 3002)**\n- **Color:** Naranja 🟠 \n- **Función:** CRUD de preguntas frecuentes\n- **Autenticación:** JWT requerido para admin\n- **Endpoints:** GET, POST, PUT, DELETE FAQs\n\n### 🤖 **Chatbot Service (Puerto 3003)**\n- **Color:** Azul Oscuro 🔷\n- **Función:** Motor de conversación IA\n- **Sin autenticación:** Para uso interno\n- **Fallback:** Dialogflow → OpenAI\n\n## 🎨 **Características de cada Swagger**\n\n### ✨ **Comunes en todos:**\n- ✅ **Try it out** funcional\n- ✅ **Ejemplos** de request/response\n- ✅ **Validación** con class-validator\n- ✅ **Códigos de error** documentados\n- ✅ **DTOs** tipados\n- ✅ **Colores personalizados** por servicio\n\n### 🔑 **Específicas:**\n\n#### **API Gateway:**\n- ✅ **JWT Authentication** configurado\n- ✅ **Rate limiting** documentado\n- ✅ **Proxy routes** explicadas\n- ✅ **CORS** configurado\n\n#### **Auth Service:**\n- ✅ **Login/Register** forms\n- ✅ **Password validation** rules\n- ✅ **JWT token** examples\n- ✅ **User roles** explained\n\n#### **FAQ Service:**\n- ✅ **CRUD operations** complete\n- ✅ **Search** functionality\n- ✅ **Categories** management\n- ✅ **Admin only** endpoints marked\n\n#### **Chatbot Service:**\n- ✅ **Conversation flow** documented\n- ✅ **Fallback logic** explained\n- ✅ **Analytics** endpoints\n- ✅ **Escalation** process\n\n## 🏃‍♂️ **Inicio Rápido**\n\n### **1. Instalar dependencias Swagger:**\n```bash\nnpm run install:swagger\n```\n\n### **2. Iniciar todos los servicios:**\n```bash\nnpm run start:dev\n```\n\n### **3. Acceder a documentación:**\n- 🌐 **Gateway:** http://localhost:3000/api/docs\n- 🔐 **Auth:** http://localhost:3001/api/docs  \n- ❓ **FAQ:** http://localhost:3002/api/docs\n- 🤖 **Chatbot:** http://localhost:3003/api/docs\n\n## 🔄 **Flujo de uso completo**\n\n### **1. Autenticación (Auth Service):**\n```bash\n# POST /auth/login\n{\n  \"email\": \"admin@test.com\",\n  \"password\": \"123456\"\n}\n# Response: { \"access_token\": \"jwt_token_here\" }\n```\n\n### **2. Usar token en API Gateway:**\n```bash\n# Header: Authorization: Bearer jwt_token_here\n# Acceso a todas las rutas protegidas\n```\n\n### **3. Chat (sin autenticación):**\n```bash\n# POST /chat/message\n{\n  \"message\": \"¿Cuáles son sus horarios?\",\n  \"sessionId\": \"user-123\"\n}\n```\n\n### **4. FAQ (con autenticación admin):**\n```bash\n# POST /faq (requiere admin token)\n{\n  \"pregunta\": \"¿Cuáles son sus horarios?\",\n  \"respuesta\": \"De 8 AM a 6 PM\",\n  \"categoria\": \"horarios\"\n}\n```\n\n## 📊 **Analytics de Documentación**\n\nCada servicio incluye métricas de uso:\n- 📈 **Requests por endpoint**\n- ⏱️ **Tiempos de respuesta**\n- 🚨 **Códigos de error**\n- 👥 **Usuarios activos**\n\n## 🐛 **Debugging**\n\n### **Problemas comunes:**\n\n#### **Error de dependencias:**\n```bash\n# Solución: Forzar instalación\nnpm install --force\n```\n\n#### **Puerto ocupado:**\n```bash\n# Verificar puertos\nnetstat -ano | findstr :3000\n# Cambiar puerto en .env\n```\n\n#### **CORS errors:**\n```bash\n# Verificar configuración en main.ts\n# Agregar origin del frontend\n```\n\n## 📋 **Checklist de Documentación**\n\n- [ ] **API Gateway** Swagger instalado y funcionando\n- [ ] **Auth Service** Swagger instalado y funcionando  \n- [ ] **FAQ Service** Swagger instalado y funcionando\n- [ ] **Chatbot Service** Swagger instalado y funcionando\n- [ ] **JWT Authentication** configurado en Gateway\n- [ ] **Rate Limiting** documentado\n- [ ] **CORS** configurado\n- [ ] **Ejemplos** de request/response en todos los endpoints\n- [ ] **Códigos de error** documentados\n- [ ] **DTOs** validados\n\n## 🎯 **Próximos pasos**\n\n1. **Instalar Swagger** en todos los servicios\n2. **Configurar main.ts** en cada servicio\n3. **Agregar anotaciones** a controllers\n4. **Crear DTOs** para validación\n5. **Probar endpoints** en Swagger UI\n6. **Documentar ejemplos** específicos\n\n---\n\n**✨ ¡Tu sistema tendrá documentación completa e interactiva en todos los microservicios! ✨**\n